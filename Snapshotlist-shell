#!/bin/bash

# Set AWS region
AWS_REGION="us-west-2"

# Define output file
OUTPUT_FILE="ebs_snapshots.csv"

# Get the list of snapshots with creation dates
echo "SnapshotID,VolumeID,StartTime" > $OUTPUT_FILE
aws ec2 describe-snapshots --region $AWS_REGION --query 'Snapshots[*].[SnapshotId,VolumeId,StartTime]' --output text | while read line; do
    SNAPSHOT_ID=$(echo $line | awk '{print $1}')
    VOLUME_ID=$(echo $line | awk '{print $2}')
    START_TIME=$(echo $line | awk '{print $3}')

    # Append the details to the output file
    echo "$SNAPSHOT_ID,$VOLUME_ID,$START_TIME" >> $OUTPUT_FILE
done

# Notify user
echo "EBS snapshots list with creation dates has been saved to $OUTPUT_FILE"



-----------------
#!/bin/bash

# Define regions to check
REGIONS=("us-east-2" "eu-west-1")

# Define output file
OUTPUT_FILE="ebs_snapshots.csv"

# Initialize the output file with a header
echo "Region,SnapshotID,VolumeID,StartTime" > $OUTPUT_FILE

# Loop through each region and fetch snapshots
for REGION in "${REGIONS[@]}"; do
    echo "Checking snapshots in region: $REGION"
    aws ec2 describe-snapshots --region $REGION --query 'Snapshots[*].[SnapshotId,VolumeId,StartTime]' --output text | while read line; do
        SNAPSHOT_ID=$(echo $line | awk '{print $1}')
        VOLUME_ID=$(echo $line | awk '{print $2}')
        START_TIME=$(echo $line | awk '{print $3}')
        
        # Append the details to the output file
        echo "$REGION,$SNAPSHOT_ID,$VOLUME_ID,$START_TIME" >> $OUTPUT_FILE
    done
done

# Notify user
echo "EBS snapshots list with creation dates has been saved to $OUTPUT_FILE"


-----------

#!/bin/bash

# Define regions to check
REGIONS=("us-east-2" "eu-west-1")

# Define output file
OUTPUT_FILE="ebs_snapshots.csv"

# Initialize the output file with a header
echo "Region,SnapshotID,VolumeID,StartTime" > $OUTPUT_FILE

# Get your AWS account ID
ACCOUNT_ID=$(aws sts get-caller-identity --query "Account" --output text)

# Loop through each region and fetch snapshots
for REGION in "${REGIONS[@]}"; do
    echo "Checking snapshots in region: $REGION"
    aws ec2 describe-snapshots --region $REGION --owner-ids $ACCOUNT_ID --query 'Snapshots[?State==`completed`].[SnapshotId,VolumeId,StartTime]' --output text | while read line; do
        SNAPSHOT_ID=$(echo $line | awk '{print $1}')
        VOLUME_ID=$(echo $line | awk '{print $2}')
        START_TIME=$(echo $line | awk '{print $3}')
        
        # Append the details to the output file
        echo "$REGION,$SNAPSHOT_ID,$VOLUME_ID,$START_TIME" >> $OUTPUT_FILE
    done
done

# Notify user
echo "EBS snapshots list with creation dates has been saved to $OUTPUT_FILE"
